<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pro FPS Shooting Game</title>
<style>
  html, body, #renderCanvas {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    display: block;
    background: #000;
  }
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    font-size: 24px;
    font-family: Arial;
    z-index: 1;
  }
</style>
</head>
<body>
<div id="score">Score: 0</div>
<canvas id="renderCanvas"></canvas>

<!-- Babylon.js libraries -->
<script src="https://cdn.babylonjs.com/babylon.js"></script>
<script src="https://cdn.babylonjs.com/loaders/babylon.glTF2FileLoader.js"></script>

<script>
let canvas = document.getElementById("renderCanvas");
let engine = new BABYLON.Engine(canvas, true);
let score = 0;

let createScene = function() {
    let scene = new BABYLON.Scene(engine);
    scene.clearColor = new BABYLON.Color3(0.1,0.1,0.1);

    // Camera - FPS
    let camera = new BABYLON.UniversalCamera("FPSCam", new BABYLON.Vector3(0,1.6,-5), scene);
    camera.fov = 1;
    camera.minZ = 0.1;
    camera.maxZ = 1000;
    camera.attachControl(canvas, true);
    camera.speed = 0.2;
    camera.checkCollisions = true;
    camera.applyGravity = true;
    scene.gravity = new BABYLON.Vector3(0,-0.9,0);

    // Light
    let light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0,1,0), scene);

    // Ground
    let ground = BABYLON.MeshBuilder.CreateGround("ground", {width:20, height:20}, scene);
    ground.checkCollisions = true;

    // ðŸ”¥ Load AK-47 Model
    BABYLON.SceneLoader.ImportMesh(
        "",
        "https://assets.babylonjs.com/meshes/",
        "Weapon.glb", 
        scene,
        function(meshes) {
            let ak47 = meshes[0];
            ak47.parent = camera;
            ak47.position = new BABYLON.Vector3(0.4, -0.6, 1.5);
            ak47.scaling = new BABYLON.Vector3(0.4, 0.4, 0.4);
            ak47.rotation = new BABYLON.Vector3(0, Math.PI, 0);
        }
    );

    // Targets
    let targets = [];
    function spawnTarget(){
        let target = BABYLON.MeshBuilder.CreateSphere("target",{diameter:0.7},scene);
        target.position = new BABYLON.Vector3((Math.random()-0.5)*10,1,(Math.random()*10)+5);
        targets.push(target);
    }
    setInterval(spawnTarget,2000);

    // Shooting
    window.addEventListener("click", ()=>{
        let forward = camera.getForwardRay();
        let hit = scene.pickWithRay(forward);
        if(hit.pickedMesh && targets.includes(hit.pickedMesh)){
            hit.pickedMesh.dispose();
            targets = targets.filter(t => t !== hit.pickedMesh);
            score += 10;
            document.getElementById("score").innerText = "Score: " + score;
        }
    });

    return scene;
};

let scene = createScene();
engine.runRenderLoop(()=>scene.render());
window.addEventListener("resize", ()=>engine.resize());
</script>
</body>
</html>
